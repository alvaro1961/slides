<!DOCTYPE html>
<html lang="en"><head>
<script src="classification_files/libs/clipboard/clipboard.min.js"></script>
<script src="classification_files/libs/quarto-html/tabby.min.js"></script>
<script src="classification_files/libs/quarto-html/popper.min.js"></script>
<script src="classification_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="classification_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="classification_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="classification_files/libs/quarto-html/quarto-syntax-highlighting-325f3ff2f131f9421fc6e27256f8a6fd.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.37">

  <meta name="author" content="Alvaro Arias">
  <title>Classification</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="classification_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="classification_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #f8f8f2; background-color: #2e3440; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #f8f8f2; } /* Normal */
    code span.al { color: #ff5555; font-weight: bold; } /* Alert */
    code span.an { color: #75715e; } /* Annotation */
    code span.at { color: #f92672; } /* Attribute */
    code span.bn { color: #ae81ff; } /* BaseN */
    code span.bu { color: #66d9ef; } /* BuiltIn */
    code span.cf { color: #f92672; } /* ControlFlow */
    code span.ch { color: #e6db74; } /* Char */
    code span.cn { color: #ae81ff; } /* Constant */
    code span.co { color: #75715e; } /* Comment */
    code span.cv { color: #75715e; } /* CommentVar */
    code span.do { color: #75715e; } /* Documentation */
    code span.dt { color: #66d9ef; font-style: italic; } /* DataType */
    code span.dv { color: #ae81ff; } /* DecVal */
    code span.er { color: #ff5555; text-decoration: underline; } /* Error */
    code span.ex { color: #a6e22e; font-weight: bold; } /* Extension */
    code span.fl { color: #ae81ff; } /* Float */
    code span.fu { color: #a6e22e; } /* Function */
    code span.im { color: #f92672; } /* Import */
    code span.in { color: #f1fa8c; } /* Information */
    code span.kw { color: #f92672; } /* Keyword */
    code span.op { color: #f8f8f2; } /* Operator */
    code span.ot { color: #a6e22e; } /* Other */
    code span.pp { color: #f92672; } /* Preprocessor */
    code span.re { color: #75715e; } /* RegionMarker */
    code span.sc { color: #ae81ff; } /* SpecialChar */
    code span.ss { color: #e6db74; } /* SpecialString */
    code span.st { color: #e6db74; } /* String */
    code span.va { color: #f8f8f2; } /* Variable */
    code span.vs { color: #e6db74; } /* VerbatimString */
    code span.wa { color: #ff5555; } /* Warning */
  </style>
  <link rel="stylesheet" href="classification_files/libs/revealjs/dist/theme/quarto-dd35d0306f5a6863b0b5c85b74390ac9.css">
  <link rel="stylesheet" href=".reveal .title {
  font-size: 2em !important;
}
.reveal .subtitle {
  font-size: 1.3em !important;
}
.reveal .author {
  font-size: 1.1em !important;
}
.reveal .date {
  font-size: 1em !important;
}">
  <link href="classification_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="classification_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="classification_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="classification_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Classification</h1>
  <p class="subtitle">Introduction to Machine Learning</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Alvaro Arias 
</div>
</div>
</div>

</section>
<section id="review-of-regression" class="slide level2 smaller">
<h2>Review of Regression</h2>
<div>
<ul>
<li class="fragment">In regression, we observe data <span class="math inline">\(\{(\mathbf{x}_i,y_i):i\leq N\}\)</span> where <span class="math inline">\(\mathbf{x}_i\in\mathbb{R}^n\)</span> and <span class="math inline">\(y_i\in\mathbb{R}\)</span></li>
<li class="fragment">We model the relationship using <span class="math inline">\(f_\theta:\mathbb{R}^n\to\mathbb{R}\)</span> to predict: <span class="math inline">\(\hat{y}_i = f_\theta(\mathbf{x}_i)\)</span></li>
<li class="fragment">The residual (error) for each observation is <span class="math inline">\(y_i-\hat{y}_i\)</span></li>
<li class="fragment">We measure overall fit using a loss function, typically: <span class="math inline">\(\text{Loss}(\theta) =\frac{1}{N}\sum_{i=1}^N(y_i-\hat{y}_i)^2\)</span></li>
<li class="fragment">Goal: find <span class="math inline">\(\theta^*\)</span> that balances minimizing training error with generalizing to unseen data (avoiding overfitting)</li>
</ul>
</div>
<div class="fragment">
<div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-1-1">Linear <span class="math inline">\(n=1\)</span></a></li><li><a href="#tabset-1-2">Polynomial <span class="math inline">\(n=1\)</span></a></li><li><a href="#tabset-1-3">Multilinear <span class="math inline">\(n&gt;1\)</span></a></li></ul>
<div class="tab-content">
<div id="tabset-1-1">
<p>In <em>simple linear regression</em> the model is <span class="math display">\[f_\theta(x)=\omega_0+\omega_1x\]</span></p>
<p>Parameters: <span class="math inline">\(\omega_0\)</span> (bias) and <span class="math inline">\(\omega_1\)</span> (weight)</p>
</div>
<div id="tabset-1-2">
<p>In<em>polynomial regression</em> the model is</p>
<p><span class="math display">\[f_\theta(x)=\omega_0+\omega_1x+\omega_2x^2+\cdots+\omega_dx^d\]</span></p>
<p>Parameters: <span class="math inline">\(\omega_0\)</span> (bias) and <span class="math inline">\((\omega_1,\omega_2,\dots,\omega_d)\)</span> (weights)</p>
</div>
<div id="tabset-1-3">
<p>In <em>multilinear regression</em> the model is</p>
<p><span class="math display">\[f_\theta((x_1,x_2,\dots,x_n))=\omega_0+\omega_1x_1+\omega_2x_2+\cdots+\omega_nx_n\]</span></p>
<p>Parameters: <span class="math inline">\(\omega_0\)</span> (bias) and <span class="math inline">\((\omega_1,\omega_2,\dots,\omega_d)\)</span> (weights)</p>
<p>The neural network diagram below visualizes this structure</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="classification_files/figure-revealjs/unnamed-chunk-2-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="binary-classification" class="slide level2 smaller">
<h2>Binary Classification</h2>
<p>In binary classification, we observe data <span class="math inline">\(\{(\mathbf{x}_i,y_i):i\leq N\}\)</span> where <span class="math inline">\(\mathbf{x}_i\in\mathbb{R}^n\)</span> and <span class="math inline">\(y_i\in\{0,1\}\)</span> is the label.</p>
<div>
<ul>
<li class="fragment">Instead of predicting a continuous value, we model <span class="math inline">\(p = P(y=1|\mathbf{x})\)</span>, the probability that <span class="math inline">\(\mathbf{x}\)</span> has label 1</li>
<li class="fragment">This implies <span class="math inline">\(1-p = P(y=0|\mathbf{x})\)</span> is the probability that <span class="math inline">\(\mathbf{x}\)</span> has label 0</li>
<li class="fragment">Therefore we model the complete <strong>probability mass function</strong> over the two classes</li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="classification_files/figure-revealjs/unnamed-chunk-3-1.png" width="384"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="section" class="slide level2 smaller">
<h2></h2>
<p><strong>The likelihood</strong> is the probability of observing the actual outcome <span class="math inline">\(y\)</span>.<br>
For this estimate, the likelihood is:</p>
<p><span class="math display">\[
\text{likelihood}=\begin{cases} p &amp;\text{if} &amp;y=1\\1-p &amp;\text{if} &amp; y=0\end{cases}\\
\]</span></p>
<p>which can be combined as: <span class="math inline">\(\quad\text{likelihood}=p^y(1-p)^{1-y}\)</span>.</p>
<div>
<ul>
<li class="fragment">A good model assigns <strong>high likelihood</strong> to the observed data.</li>
<li class="fragment">This motivates choosing parameters that <strong>maximize the likelihood</strong>, a fundamental principle in statistics called <strong>Maximum Likelihood Estimation (MLE)</strong>.</li>
<li class="fragment">MLE is a cornerstone of statistical inference, used across countless applications from biology to economics to machine learning.</li>
</ul>
</div>
</section>
<section id="binary-classification-mle" class="slide level2 smaller">
<h2>Binary Classification: MLE</h2>
<p>We model the probability using <span class="math inline">\(f_\theta:\mathbb{R}^n\to [0,1]\)</span> where <span class="math inline">\(f_\theta(\mathbf{x})\)</span> estimates the probabilty that the label of <span class="math inline">\(x\)</span> is 1.</p>
<div class="fragment">
<p><strong>Maximum Likelihood Estimation (MLE)</strong>: Choose <span class="math inline">\(\theta^*\)</span> that maximizes the probability of observing our data</p>
</div>
<div class="fragment">
<p><strong>Likelihood for all observations:</strong> <span class="math display">\[\mathcal{L}(\theta) = \prod_{i=1}^N f_\theta(\mathbf{x}_i)^{y_i}(1-f_\theta(\mathbf{x}_i))^{1-y_i}\]</span></p>
</div>
<div class="fragment">
<p><strong>Log-likelihood</strong> (easier to optimize): <span class="math display">\[\log \mathcal{L}(\theta) = \sum_{i=1}^N \left[ y_i\log(f_\theta(\mathbf{x}_i))+(1-y_i)\log(1-f_\theta(\mathbf{x}_i))\right]\]</span></p>
</div>
<div class="fragment">
<p><strong>Binary Cross-Entropy Loss</strong> (negate and average): <span class="math display">\[\text{Loss}(\theta) = -\frac{1}{N}\sum_{i=1}^N\left[ y_i\log(f_\theta(\mathbf{x}_i))+(1-y_i)\log(1-f_\theta(\mathbf{x}_i))\right]\]</span></p>
<p>Minimizing this loss ≡ Maximizing the likelihood</p>
</div>
</section>
<section id="logistic-regression" class="slide level2 smaller">
<h2>Logistic Regression</h2>
<p>In <em>Logistic Regression</em>, we model the probability using: <span class="math display">\[f_\theta(\mathbf{x})=\sigma(\omega_0+\omega_1x_1+\dots+\omega_nx_n)\]</span></p>
<div class="columns">
<div class="column" style="width:50%;">
<p>where <span class="math inline">\(\sigma:\mathbb{R}\to[0,1]\)</span> is the <strong>sigmoid function</strong>: <span class="math display">\[\sigma(t)=\frac{1}{1+e^{-t}}=\frac{e^t}{1+e^t}\]</span></p>
<p>The sigmoid maps any real number to a probability in <span class="math inline">\([0,1]\)</span>.</p>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="classification_files/figure-revealjs/unnamed-chunk-4-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="section-1" class="slide level2 smaller">
<h2></h2>
<p><em>Logistic Regression</em> combines multilinear regression with the sigmoid activation function:</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Step 1: Linear combination</strong> <span class="math display">\[z = \omega_0+\omega_1x_1+\dots+\omega_nx_n\]</span> The linear part produces <span class="math inline">\(z\in\mathbb{R}\)</span></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="classification_files/figure-revealjs/unnamed-chunk-5-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><strong>Step 2: Sigmoid transformation</strong> <span class="math display">\[z\longrightarrow \sigma(z) = \frac{1}{1+e^{-z}}\]</span></p>
<p>The sigmoid maps <span class="math inline">\(z\)</span> to a probability in <span class="math inline">\([0,1]\)</span></p>
</div></div>
<div class="fragment">
<p><strong>Limitation</strong>: Since the decision boundary is linear, logistic regression only works well when classes are approximately <strong>linearly separable</strong>. Non-linear patterns require more complex models.</p>
</div>
</section>
<section id="model-selection-training-and-testing" class="slide level2 smaller" data-transition="slide-in none-out">
<h2>Model Selection: Training and Testing</h2>
<p>Similar to regression, we split our data to prevent overfitting:</p>
<div>
<ul>
<li class="fragment"><p><strong>Training set</strong> <span class="math inline">\(\{(\mathbf{x}_i,y_i):i\in\text{Train}\}\)</span>: Used to find optimal parameters <span class="math inline">\(\theta^*\)</span> <span class="math display">\[\theta^* = \arg\min_\theta \text{Loss}_{\text{train}}(\theta)\]</span></p></li>
<li class="fragment"><p><strong>Test set</strong> <span class="math inline">\(\{(\mathbf{x}_i,y_i):i\in\text{Test}\}\)</span>: Used to evaluate generalization: <span class="math inline">\(\text{Loss}_{\text{test}}(\theta^*)\)</span></p></li>
<li class="fragment"><p><strong>Overfitting detection</strong>: If <span class="math inline">\(\text{Loss}_{\text{train}} \ll \text{Loss}_{\text{test}}\)</span>, the model memorizes training data rather than learning patterns</p></li>
<li class="fragment"><p><strong>Preventing overfitting</strong>: Add regularization penalties to the loss function</p>
<ul>
<li class="fragment"><strong>Ridge (L2)</strong>: <span class="math inline">\(\text{Loss}_{\text{regularized}}(\theta) = \text{Loss}(\theta) + \lambda\sum_{j=1}^n\omega_j^2\)</span></li>
<li class="fragment"><strong>Lasso (L1)</strong>: <span class="math inline">\(\text{Loss}_{\text{regularized}}(\theta) = \text{Loss}(\theta) + \lambda\sum_{j=1}^n|\omega_j|\)</span></li>
</ul></li>
</ul>
</div>
<div class="fragment">
<p>For classification we have more interpretable metrics than just loss and accuracy of predictions. These metrics help us understand <em>how</em> our model fails, not just <em>that</em> it fails.</p>
</div>
</section>
<section id="evaluation-metrics-beyond-loss" class="slide level2 smaller" data-transition="slide-in none-out">
<h2>Evaluation Metrics: Beyond Loss</h2>
<p>For binary classification, the <strong>confusion matrix</strong> provides interpretable performance metrics:</p>
<div class="columns">
<div class="column" style="width:50%;">
<table class="caption-top">
<thead>
<tr class="header">
<th></th>
<th>Predicted 0</th>
<th>Predicted 1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Actual 0</strong></td>
<td>TN</td>
<td>FP</td>
</tr>
<tr class="even">
<td><strong>Actual 1</strong></td>
<td>FN</td>
<td>TP</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>True Positive (TP)</strong>: Correctly predicted 1</li>
<li><strong>True Negative (TN)</strong>: Correctly predicted 0</li>
<li><strong>False Positive (FP)</strong>: Incorrectly predicted 1 (Type I error)</li>
<li><strong>False Negative (FN)</strong>: Incorrectly predicted 0 (Type II error)</li>
</ul>
</div><div class="column" style="width:50%;">
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="classification_files/figure-revealjs/unnamed-chunk-6-1.png" class="quarto-figure quarto-figure-center" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
</div></div>
</section>
<section id="evaluation-metrics-beyond-loss-1" class="slide level2 smaller" data-transition="none">
<h2>Evaluation Metrics: Beyond Loss</h2>
<p>These metrics are central to ethical AI. Medical professionals have dealt with these tradeoffs for decades.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="fragment">
<p><strong>Medical Stat Terms</strong></p>
</div>
<div>
<ul>
<li class="fragment"><em>Sensitivity</em> <span class="math inline">\(=\frac{TP}{TP+FN}\)</span> (probability test detects disease when present)</li>
<li class="fragment"><em>Specificity</em> <span class="math inline">\(=\frac{TN}{TN+FP}\)</span> (probability test is negative when disease absent)</li>
<li class="fragment"><em>Positive Predictive Value (PPV)</em> <span class="math inline">\(=\frac{TP}{TP+FP}\)</span> (probability of disease given positive test)</li>
<li class="fragment"><em>Negative Predictive Value (NPV)</em> <span class="math inline">\(=\frac{TN}{TN+FN}\)</span> (probability no disease given negative test)</li>
</ul>
</div>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="classification_files/figure-revealjs/unnamed-chunk-7-1.png" class="quarto-figure quarto-figure-center" width="768"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="when-the-condition-is-rare" class="slide level2 smaller">
<h2>When the Condition is Rare</h2>
<p><strong>A “Good” Diagnostic Test:</strong></p>
<ul>
<li><strong>Sensitivity (Recall):</strong> 95% - catches 95% of true cases</li>
<li><strong>Specificity:</strong> 99% - correctly identifies 99% of negatives</li>
</ul>
<p>Sounds impressive, right? Let’s see what happens in practice…</p>
<div class="fragment">
<div class="panel-tabset smaller">
<ul id="tabset-2" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-2-1">Prevalence: 50%</a></li><li><a href="#tabset-2-2">Prevalence: 10%</a></li><li><a href="#tabset-2-3">Prevalence: 1%</a></li><li><a href="#tabset-2-4">Prevalence: 0.1%</a></li></ul>
<div class="tab-content smaller">
<div id="tabset-2-1">
<div class="fragment">
<p><strong>Testing 1,000 people (500 have condition)</strong></p>
<table class="caption-top">
<colgroup>
<col style="width: 28%">
<col style="width: 27%">
<col style="width: 27%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>Actually Positive</th>
<th>Actually Negative</th>
<th><strong>Total</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Test Positive</strong></td>
<td>475</td>
<td>5</td>
<td><strong>480</strong></td>
</tr>
<tr class="even">
<td><strong>Test Negative</strong></td>
<td>25</td>
<td>495</td>
<td><strong>520</strong></td>
</tr>
</tbody>
</table>
</div>
<div class="fragment">
<ul>
<li><strong>PPV (Precision):</strong> 475/480 = <strong>99.0%</strong> ✓</li>
<li><strong>NPV:</strong> 495/520 = <strong>95.2%</strong> ✓</li>
<li>When prevalence is balanced, the test performs well!</li>
</ul>
</div>
</div>
<div id="tabset-2-2">
<p><strong>Testing 1,000 people (100 have condition)</strong></p>
<table class="caption-top">
<colgroup>
<col style="width: 28%">
<col style="width: 27%">
<col style="width: 27%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>Actually Positive</th>
<th>Actually Negative</th>
<th><strong>Total</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Test Positive</strong></td>
<td>95</td>
<td>9</td>
<td><strong>104</strong></td>
</tr>
<tr class="even">
<td><strong>Test Negative</strong></td>
<td>5</td>
<td>891</td>
<td><strong>896</strong></td>
</tr>
</tbody>
</table>
<div class="fragment">
<ul>
<li><strong>PPV (Precision):</strong> 95/104 = <strong>91.3%</strong> ✓</li>
<li><strong>NPV:</strong> 891/896 = <strong>99.4%</strong> ✓</li>
<li>Performance declining but acceptable</li>
</ul>
</div>
</div>
<div id="tabset-2-3">
<p><strong>Testing 10,000 people (100 have condition)</strong></p>
<table class="caption-top" style="width:100%;">
<colgroup>
<col style="width: 28%">
<col style="width: 26%">
<col style="width: 26%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>Actually Positive</th>
<th>Actually Negative</th>
<th><strong>Total</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Test Positive</strong></td>
<td>95</td>
<td>99</td>
<td><strong>194</strong></td>
</tr>
<tr class="even">
<td><strong>Test Negative</strong></td>
<td>5</td>
<td>9,801</td>
<td><strong>9,806</strong></td>
</tr>
</tbody>
</table>
<div class="fragment">
<ul>
<li><strong>PPV (Precision):</strong> 95/194 = <strong>48.96%</strong> ⚠️</li>
<li><strong>NPV:</strong> 9,801/9,806 = <strong>99.94%</strong> ✓</li>
<li>Less than half of positive predictions are correct!</li>
</ul>
</div>
</div>
<div id="tabset-2-4">
<p><strong>Testing 100,000 people (100 have condition)</strong></p>
<table class="caption-top" style="width:100%;">
<colgroup>
<col style="width: 28%">
<col style="width: 26%">
<col style="width: 26%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>Actually Positive</th>
<th>Actually Negative</th>
<th><strong>Total</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Test Positive</strong></td>
<td>95</td>
<td>999</td>
<td><strong>1,094</strong></td>
</tr>
<tr class="even">
<td><strong>Test Negative</strong></td>
<td>5</td>
<td>98,901</td>
<td><strong>98,906</strong></td>
</tr>
</tbody>
</table>
<div class="fragment">
<ul>
<li><strong>PPV (Precision):</strong> 95/1,094 = <strong>8.7%</strong> ⚠️</li>
<li><strong>NPV:</strong> 98,901/98,906 = <strong>99.99%</strong> ✓</li>
<li><strong>Less than 1 in 10 positive predictions are correct!</strong></li>
</ul>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="machine-learning-metrics" class="slide level2 smaller">
<h2>Machine Learning Metrics</h2>
<p>In ML, we often focus on <strong>Recall</strong> and <strong>Precision</strong> rather than <em>Sensitivity</em> and <em>Specificity</em>:</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="fragment">
<h3 id="recall-sensitivity">Recall = Sensitivity</h3>
<p><span class="math display">\[\text{Recall} = \frac{\text{TP}}{\text{TP + FN}}\]</span></p>
<p><em>Of all actual positives, how many did we catch?</em></p>
<ul>
<li><strong>Not affected by prevalence</strong></li>
</ul>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment">
<h3 id="precision-ppv">Precision = PPV</h3>
<p><span class="math display">\[\text{Precision} = \frac{\text{TP}}{\text{TP + FP}}\]</span></p>
<p><em>Of all predicted positives, how many are correct?</em></p>
<ul>
<li><strong>Heavily affected by prevalence (base rates)</strong></li>
</ul>
</div>
</div></div>
<div class="fragment">
<h3 id="why-this-matters-for-rare-conditions">Why this matters for rare conditions</h3>
<p>Remember our 0.1% prevalence example: <strong>Recall = 95%</strong>, but <strong>Precision = 8.7%</strong></p>
<p>→ The model catches most cases, but most alerts are false alarms!</p>
</div>
<aside class="notes">
<p>Precision reveals what Specificity hides: when the condition is rare, even a small false positive rate creates many more false alarms than true detections.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="section-2" class="slide level2 smaller">
<h2></h2>
<div class="panel-tabset">
<ul id="tabset-3" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-3-1">High Recall, Medium Precision</a></li><li><a href="#tabset-3-2">High Precision, Lower Recall</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1">
<div class="columns">
<div class="column" style="width:40%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="classification_files/figure-revealjs/unnamed-chunk-8-1.png" class="quarto-figure quarto-figure-center" width="768"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:30%;">
<div class="fragment">
<p><strong>When is this appropriate?</strong></p>
</div>
<div>
<ul>
<li class="fragment">Early medical screening (e.g.&nbsp;cancer pre-screening)<br>
</li>
<li class="fragment">Fraud or anomaly detection used to trigger human review<br>
</li>
<li class="fragment">Search or recommendation systems where the user is free to ignore suggestions</li>
</ul>
</div>
</div><div class="column" style="width:30%;">
<div class="fragment">
<p><strong>When is this inappropriate?</strong></p>
</div>
<div>
<ul>
<li class="fragment">Automated punishment or denial (e.g.&nbsp;loan rejection, policing)<br>
</li>
<li class="fragment">Expensive or harmful interventions with no review step<br>
</li>
<li class="fragment">Situations where false accusations carry social or legal stigma</li>
</ul>
</div>
</div></div>
</div>
<div id="tabset-3-2">
<div class="columns">
<div class="column" style="width:40%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="classification_files/figure-revealjs/unnamed-chunk-9-1.png" class="quarto-figure quarto-figure-center" width="768"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:30%;">
<div class="fragment">
<p><strong>When is this appropriate?</strong></p>
</div>
<div>
<ul>
<li class="fragment">Automated actions with serious consequences (e.g.&nbsp;account suspension, benefit denial)<br>
</li>
<li class="fragment">Legal or disciplinary decisions where false accusations must be minimized<br>
</li>
<li class="fragment">Situations requiring very high confidence before acting</li>
</ul>
</div>
</div><div class="column" style="width:30%;">
<div class="fragment">
<p><strong>When is this inappropriate?</strong></p>
</div>
<div>
<ul>
<li class="fragment">Early screening or detection of rare but serious conditions<br>
</li>
<li class="fragment">Safety-critical monitoring where missed cases can cause harm<br>
</li>
<li class="fragment">Systems intended to provide help or protection rather than punishment</li>
</ul>
</div>
</div></div>
</div>
</div>
</div>
</section>
<section id="from-predictions-to-decisions" class="slide level2 smaller">
<h2>From Predictions to Decisions</h2>
<p>A classifier produces a <strong>probability</strong> <span class="math inline">\(p\)</span>, not a yes/no answer.</p>
<p>We must choose a <strong>decision rule</strong>:</p>
<p><span class="math display">\[
\text{Predict positive if } p &gt; t
\]</span></p>
<ul>
<li>The common choice <span class="math inline">\(t = 0.5\)</span> is <strong>conventional, not natural</strong></li>
<li>Different values of <span class="math inline">\(t\)</span> lead to different outcomes</li>
</ul>
<div class="fragment">
<h3 id="what-changing-t-does">What changing <span class="math inline">\(t\)</span> does</h3>
<ul>
<li>Increasing <span class="math inline">\(t\)</span>: fewer positives<br>
→ <strong>fewer false positives</strong>, more missed cases</li>
<li>Decreasing <span class="math inline">\(t\)</span>: more positives<br>
→ <strong>more false positives</strong>, fewer missed cases</li>
</ul>
</div>
<div class="fragment">
<h3 id="this-is-not-a-technical-choice">This is not a technical choice</h3>
<p>Choosing <span class="math inline">\(t\)</span> <strong>weights the cost</strong> of:</p>
<ul>
<li>false positives (unnecessary alarms, interventions)</li>
<li>false negatives (missed cases, lack of help)</li>
</ul>
<p>The “right” threshold depends on <strong>context, values, and consequences</strong>, not on the algorithm alone.</p>
</div>
</section>
<section id="application-breast-cancer-classification" class="slide level2 smaller">
<h2>Application: Breast Cancer Classification</h2>
<p><strong>Dataset</strong>: Wisconsin Breast Cancer Database (from <code>MASS</code> package)</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="smaller">
<ul>
<li>Samples from breast masses</li>
<li>Goal: Classify tumors as <strong>benign</strong> or <strong>malignant</strong></li>
</ul>
</div>
<p><strong>Outcome variable:</strong></p>
<ul>
<li><em>Class</em>: benign or malignant</li>
</ul>
<p><strong>Sample size:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb1-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(biopsy)</span>
<span id="cb1-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(biopsy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 699</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(biopsy<span class="sc">$</span>class)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   benign malignant 
      458       241 </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment">
<p><strong>Predictor variables</strong> (all scaled 1-10):</p>
<ul>
<li><code>V1</code>: Clump thickness</li>
<li><code>V2</code>: Uniformity of cell size</li>
<li><code>V3</code>: Uniformity of cell shape</li>
<li><code>V4</code>: Marginal adhesion</li>
<li><code>V5</code>: Single epithelial cell size</li>
<li><code>V6</code>: Bare nuclei</li>
<li><code>V7</code>: Bland chromatin</li>
<li><code>V8</code>: Normal nucleoli</li>
<li><code>V9</code>: Mitoses</li>
</ul>
<p>All features describe cellular characteristics visible under microscopy.</p>
</div>
</div></div>
<div class="fragment">
<p><strong>Question</strong>: Can we predict malignancy from these cellular features?</p>
</div>
</section>
<section id="building-the-model-simple-logistic-regression" class="slide level2 smaller">
<h2>Building the Model: Simple Logistic Regression</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Step 1: Train/Test Split (70/30)</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean data (remove NAs)</span></span>
<span id="cb5-2"><a href="" aria-hidden="true" tabindex="-1"></a>biopsy_clean <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(biopsy)</span>
<span id="cb5-3"><a href="" aria-hidden="true" tabindex="-1"></a>biopsy_clean<span class="sc">$</span>malignant <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(biopsy_clean<span class="sc">$</span>class <span class="sc">==</span> <span class="st">"malignant"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb5-4"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Train/test split</span></span>
<span id="cb5-6"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb5-7"><a href="" aria-hidden="true" tabindex="-1"></a>train_idx <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(biopsy_clean), </span>
<span id="cb5-8"><a href="" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">0.7</span> <span class="sc">*</span> <span class="fu">nrow</span>(biopsy_clean))</span>
<span id="cb5-9"><a href="" aria-hidden="true" tabindex="-1"></a>train_bc <span class="ot">&lt;-</span> biopsy_clean[train_idx, ]</span>
<span id="cb5-10"><a href="" aria-hidden="true" tabindex="-1"></a>test_bc <span class="ot">&lt;-</span> biopsy_clean[<span class="sc">-</span>train_idx, ]</span>
<span id="cb5-11"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Training samples:"</span>, <span class="fu">nrow</span>(train_bc), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Training samples: 478 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Test samples:"</span>, <span class="fu">nrow</span>(test_bc), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test samples: 205 </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment">
<p><strong>Step 2: Fit Simple Model</strong></p>
<p>Start with 3 clinically important features:</p>
<ul>
<li><code>V1</code>: Clump thickness</li>
<li><code>V2</code>: Cell size uniformity<br>
</li>
<li><code>V6</code>: Bare nuclei</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="" aria-hidden="true" tabindex="-1"></a>model_simple <span class="ot">&lt;-</span> <span class="fu">glm</span>(malignant <span class="sc">~</span> V1 <span class="sc">+</span> V2 <span class="sc">+</span> V6, </span>
<span id="cb9-2"><a href="" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> train_bc, </span>
<span id="cb9-3"><a href="" aria-hidden="true" tabindex="-1"></a>                    <span class="at">family =</span> binomial)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div></div>
</section>
<section id="section-3" class="slide level2 smaller">
<h2></h2>
<p><strong>Model Summary:</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = malignant ~ V1 + V2 + V6, family = binomial, data = train_bc)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -7.7957     0.9218  -8.457  &lt; 2e-16 ***
V1            0.4932     0.1506   3.275  0.00105 ** 
V2            0.8014     0.1703   4.705 2.54e-06 ***
V6            0.5965     0.1063   5.611 2.01e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 625.719  on 477  degrees of freedom
Residual deviance:  89.173  on 474  degrees of freedom
AIC: 97.173

Number of Fisher Scoring iterations: 7</code></pre>
</div>
</div>
<p>All three predictors are highly significant</p>
</section>
<section id="model-evaluation-test-set-performance" class="slide level2 smaller">
<h2>Model Evaluation: Test Set Performance</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Generate Predictions:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict probabilities on test set</span></span>
<span id="cb11-2"><a href="" aria-hidden="true" tabindex="-1"></a>test_bc<span class="sc">$</span>pred_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_simple, </span>
<span id="cb11-3"><a href="" aria-hidden="true" tabindex="-1"></a>                              <span class="at">newdata =</span> test_bc, </span>
<span id="cb11-4"><a href="" aria-hidden="true" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb11-5"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to class predictions (threshold = 0.5)</span></span>
<span id="cb11-7"><a href="" aria-hidden="true" tabindex="-1"></a>test_bc<span class="sc">$</span>pred_class <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(test_bc<span class="sc">$</span>pred_prob <span class="sc">&gt;</span> <span class="fl">0.5</span>, </span>
<span id="cb11-8"><a href="" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"malignant"</span>, <span class="st">"benign"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Confusion Matrix:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="at">Actual =</span> test_bc<span class="sc">$</span>class, </span>
<span id="cb12-2"><a href="" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Predicted =</span> test_bc<span class="sc">$</span>pred_class)</span>
<span id="cb12-3"><a href="" aria-hidden="true" tabindex="-1"></a>conf_matrix</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Predicted
Actual      benign malignant
  benign       136         3
  malignant      5        61</code></pre>
</div>
</div>
<div class="fragment">
<p><strong>Performance Metrics:</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy:  0.961 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Precision: 0.953 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Recall:    0.924 </code></pre>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment">
<p><strong>Distribution of Predicted Probabilities:</strong></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="classification_files/figure-revealjs/unnamed-chunk-17-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
<p>The red dashed line shows the 0.5 decision threshold.</p>
</div>
</div></div>
</section>
<section id="multiclass-classification" class="slide level2 smaller">
<h2>Multiclass Classification</h2>
<p>In <em>multiclass classification</em>, we observe data <span class="math inline">\(\{(\mathbf{x}_i,y_i):i\leq N\}\)</span> where <span class="math inline">\(\mathbf{x}_i\in\mathbb{R}^n\)</span> and <span class="math inline">\(y_i\in\{1,2,\dots,C\}\)</span> is the label.</p>
<div>
<ul>
<li class="fragment">We model the <strong>probability mass function</strong> over all <span class="math inline">\(C\)</span> classes for each input <span class="math inline">\(\mathbf{x}\)</span></li>
<li class="fragment">The model is <span class="math inline">\(f_\theta:\mathbb{R}^n\to\mathbb{R}^C\)</span> defined by: <span class="math display">\[f_\theta(\mathbf{x})=(p_1(\mathbf{x}),p_2(\mathbf{x}),\dots,p_C(\mathbf{x}))\]</span> where <span class="math inline">\(p_k(\mathbf{x}) = P(y=k|\mathbf{x})\)</span> represents the probability that <span class="math inline">\(\mathbf{x}\)</span> belongs to class <span class="math inline">\(k\)</span></li>
<li class="fragment"><strong>Required conditions</strong>: The probabilities must satisfy:
<ul>
<li class="fragment"><span class="math inline">\(p_k(\mathbf{x}) \geq 0\)</span> for all <span class="math inline">\(k=1,\dots,C\)</span> (non-negative)</li>
<li class="fragment"><span class="math inline">\(\sum_{k=1}^C p_k(\mathbf{x}) = 1\)</span> (sum to one)</li>
</ul></li>
</ul>
</div>
</section>
<section id="section-4" class="slide level2 smaller">
<h2></h2>
<p>For each input <span class="math inline">\(\mathbf{x}\)</span>, our model predicts probabilities for all classes:</p>

<img data-src="classification_files/figure-revealjs/unnamed-chunk-18-1.png" width="576" class="r-stretch"><div class="fragment">
<p><strong>The likelihood</strong> is the probability of observing the actual outcome. For an observation with true class <span class="math inline">\(y\)</span>, the likelihood is simply: <span class="math display">\[\text{likelihood} = p_y(\mathbf{x})\]</span></p>
</div>
<div class="fragment">
<p>As in binary classification, we choose parameters <span class="math inline">\(\theta^*\)</span> by <strong>Maximum Likelihood Estimation (MLE)</strong>, selecting the model that assigns the highest probability to the observed data.</p>
</div>
</section>
<section id="multiclass-classification-mle" class="slide level2 smaller">
<h2>Multiclass Classification: MLE</h2>
<div class="fragment">
<p><strong>Maximum Likelihood Estimation (MLE)</strong>: Choose <span class="math inline">\(\theta^*\)</span> that maximizes the probability of observing our data</p>
</div>
<div class="fragment">
<p><strong>Likelihood for all observations:</strong> <span class="math display">\[\mathcal{L}(\theta) = \prod_{i=1}^N p_{y_i}(\mathbf{x}_i)\]</span> where <span class="math inline">\(p_{y_i}(\mathbf{x}_i)\)</span> is the model’s predicted probability for the true class <span class="math inline">\(y_i\)</span></p>
</div>
<div class="fragment">
<p><strong>Log-likelihood</strong> (easier to optimize): <span class="math display">\[\log \mathcal{L}(\theta) = \sum_{i=1}^N \log(p_{y_i}(\mathbf{x}_i))\]</span></p>
</div>
<div class="fragment">
<p><strong>Cross-Entropy Loss</strong> (negate and average): <span class="math display">\[\text{Loss}(\theta) = -\frac{1}{N}\sum_{i=1}^N\log(p_{y_i}(\mathbf{x}_i))\]</span></p>
<p>Minimizing this loss ≡ Maximizing the likelihood</p>
</div>
<div class="fragment">
<p><strong>Note</strong>: This generalizes binary cross-entropy—when <span class="math inline">\(C=2\)</span>, we recover the binary classification loss.</p>
</div>
</section>
<section id="understanding-cross-entropy-loss" class="slide level2 smaller">
<h2>Understanding Cross-Entropy Loss</h2>
<div class="fragment">
<p><strong>Cross-entropy</strong> measures how well a predicted probability distribution <span class="math inline">\(Q\)</span> approximates a true distribution <span class="math inline">\(P\)</span>: <span class="math display">\[H(P, Q) = -\sum_{k=1}^C P(k) \log Q(k)\]</span> Lower cross-entropy = better approximation</p>
</div>
<div class="fragment">
<p><strong>In our classification setting:</strong></p>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>True distribution</strong> <span class="math inline">\(P\)</span> (one-hot): <span class="math display">\[P(k) = \begin{cases} 1 &amp;\text{if } k=y\\0 &amp;\text{otherwise}\end{cases}\]</span></p>
<p>For example, if true class is <span class="math inline">\(y=2\)</span>:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="classification_files/figure-revealjs/unnamed-chunk-19-1.png" width="384"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><strong>Predicted distribution</strong> <span class="math inline">\(Q\)</span>: <span class="math display">\[Q(k) = p_k(\mathbf{x})\]</span></p>
<p>Model’s prediction:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="classification_files/figure-revealjs/unnamed-chunk-20-1.png" width="384"></p>
</figure>
</div>
</div>
</div>
</div></div>
</div>
<div class="fragment">
<p><strong>Simplification</strong>: Since <span class="math inline">\(P(k)=1\)</span> only for <span class="math inline">\(k=y\)</span> and <span class="math inline">\(P(k)=0\)</span> elsewhere: <span class="math display">\[H(P, Q) = -\sum_{k=1}^C P(k) \log Q(k) = -\log Q(y) = -\log p_y(\mathbf{x})\]</span> This is exactly our loss function (averaged over all samples)!</p>
</div>
<div class="fragment">
<p><strong>Connection to KL Divergence</strong>: Cross-entropy is related to the Kullback–Leibler divergence, <span class="math display">\[
H(P,Q) = \mathrm{KL}(P\|Q) + H(P).
\]</span> Since <span class="math inline">\(H(P)\)</span> is constant (and zero for one-hot labels), minimizing cross-entropy is equivalent to minimizing KL divergence, a fundamental measure of distributional difference used throughout statistics, information theory, and machine learning, including variational inference, VAEs, and diffusion models.</p>
</div>
</section>
<section id="multiclass-logistic-regression" class="slide level2 smaller">
<h2>Multiclass Logistic Regression</h2>
<p>In <em>Multiclass Logistic Regression</em> (also called <em>Softmax Regression</em>), we model the probability distribution using: <span class="math display">\[f_\theta(\mathbf{x})=\text{softmax}(\mathbf{z}(\mathbf{x}))\]</span></p>
<p>where <span class="math inline">\(\mathbf{z}(\mathbf{x}) = W\mathbf{x}+\mathbf{b}\)</span> computes the linear scores for each class: <span class="math display">\[\mathbf{z}(\mathbf{x}) = (z_1(\mathbf{x}), z_2(\mathbf{x}), \dots, z_C(\mathbf{x}))\]</span></p>
<p>Here, <span class="math inline">\(W\)</span> is a <span class="math inline">\(C \times n\)</span> weight matrix and <span class="math inline">\(\mathbf{b}\in\mathbb{R}^C\)</span> is the bias vector.</p>
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<p>The <strong>softmax function</strong> <span class="math inline">\(\text{softmax}:\mathbb{R}^C\to[0,1]^C\)</span> is defined by: <span class="math display">\[\text{softmax}(\mathbf{z})_k = \frac{e^{z_k}}{\sum_{j=1}^C e^{z_j}}\]</span></p>
<p>Softmax converts any vector of real numbers into a valid probability distribution (non-negative, sums to 1).</p>
<p><strong>Key property</strong>: Larger scores → higher probabilities</p>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="classification_files/figure-revealjs/unnamed-chunk-21-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
</div></div>
</div>
</section>
<section id="section-5" class="slide level2 smaller">
<h2></h2>
<p><em>Multiclass Logistic Regression</em> combines an <strong>affine map</strong> <span class="math inline">\(\mathbf{z}:\mathbb{R}^n\to \mathbb{R}^C\)</span> with the softmax activation:</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Step 1: Linear scores for each class</strong> <span class="math display">\[\mathbf{z}(\mathbf{x}) = W\mathbf{x}+\mathbf{b}\]</span> where <span class="math inline">\(W\)</span> is a <span class="math inline">\(C \times n\)</span> weight matrix and <span class="math inline">\(\mathbf{b}\in\mathbb{R}^C\)</span> is the bias vector.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="classification_files/figure-revealjs/unnamed-chunk-22-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<p>Each output node computes a score <span class="math inline">\(z_k\in\mathbb{R}\)</span></p>
</div><div class="column" style="width:50%;">
<p><strong>Step 2: Softmax transformation</strong></p>
<p><span class="math display">\[\begin{array}{c}
\mathbf{z}=(z_1,\dots,z_C)\\
\downarrow\\
\text{softmax}(\mathbf{z})=(p_1,\dots,p_C)
\end{array}\]</span></p>
<p>where <span class="math inline">\(p_k = \frac{e^{z_k}}{\sum_{j=1}^C e^{z_j}}\)</span></p>
<p>The softmax ensures:</p>
<ul>
<li>All probabilities are non-negative</li>
<li>Probabilities sum to 1: <span class="math inline">\(\sum_{k=1}^C p_k = 1\)</span></li>
</ul>
<p><strong>Prediction</strong>: Choose class with highest probability <span class="math display">\[\hat{y} = \arg\max_{k} p_k(\mathbf{x})\]</span></p>
</div></div>
<p><strong>Limitation</strong>: Decision boundaries between classes are still <strong>linear</strong> (piecewise linear overall). Non-linear patterns require neural networks with hidden layers.</p>
</section>
<section id="application-the-iris-dataset" class="slide level2 smaller">
<h2>Application: The Iris Dataset</h2>
<p><strong>One of the most famous dataset in statistics and machine learning</strong></p>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Historical Context:</strong></p>
<ul>
<li>Published by Ronald Fisher in 1936</li>
<li>Used to demonstrate linear discriminant analysis</li>
<li>Collected by botanist Edgar Anderson in the Gaspé Peninsula, Quebec</li>
<li>Still widely used 90 years later for teaching classification!</li>
</ul>
<div class="fragment">
<p><strong>The Classification Task:</strong> Predict iris species from flower measurements</p>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment">
<p><strong>The 3 Species:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(datasets)</span>
<span id="cb17-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb17-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(iris<span class="sc">$</span>Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    setosa versicolor  virginica 
        50         50         50 </code></pre>
</div>
</div>
<p>50 samples per species (150 total)</p>
</div>
<div class="fragment">
<p><strong>The 4 Features (in cm):</strong></p>
<ul>
<li><code>Sepal.Length</code>: Length of sepal</li>
<li><code>Sepal.Width</code>: Width of sepal<br>
</li>
<li><code>Petal.Length</code>: Length of petal</li>
<li><code>Petal.Width</code>: Width of petal</li>
</ul>
</div>
</div></div>
</section>
<section id="section-6" class="slide level2">
<h2></h2>

<img data-src="classification_files/figure-revealjs/unnamed-chunk-24-1.png" width="768" class="r-stretch"></section>
<section id="model-training-and-predictions" class="slide level2 smaller">
<h2>Model Training and Predictions</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Step 1: Prepare Data</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert species to numeric labels</span></span>
<span id="cb19-2"><a href="" aria-hidden="true" tabindex="-1"></a>iris<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(iris<span class="sc">$</span>Species)</span>
<span id="cb19-3"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Train/test split (70/30)</span></span>
<span id="cb19-5"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb19-6"><a href="" aria-hidden="true" tabindex="-1"></a>train_idx <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(iris), <span class="fl">0.7</span> <span class="sc">*</span> <span class="fu">nrow</span>(iris))</span>
<span id="cb19-7"><a href="" aria-hidden="true" tabindex="-1"></a>train_iris <span class="ot">&lt;-</span> iris[train_idx, ]</span>
<span id="cb19-8"><a href="" aria-hidden="true" tabindex="-1"></a>test_iris <span class="ot">&lt;-</span> iris[<span class="sc">-</span>train_idx, ]</span>
<span id="cb19-9"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Training samples:"</span>, <span class="fu">nrow</span>(train_iris), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Training samples: 105 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Test samples:"</span>, <span class="fu">nrow</span>(test_iris), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test samples: 45 </code></pre>
</div>
</div>
<div class="fragment">
<p><strong>Step 2: Fit Softmax Regression</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet)</span>
<span id="cb23-2"><a href="" aria-hidden="true" tabindex="-1"></a>model_iris <span class="ot">&lt;-</span> <span class="fu">multinom</span>(Species <span class="sc">~</span> Sepal.Length <span class="sc">+</span> Sepal.Width <span class="sc">+</span> </span>
<span id="cb23-3"><a href="" aria-hidden="true" tabindex="-1"></a>                            Petal.Length <span class="sc">+</span> Petal.Width,</span>
<span id="cb23-4"><a href="" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> train_iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  18 (10 variable)
initial  value 115.354290 
iter  10 value 16.619564
iter  20 value 2.934473
iter  30 value 2.237217
iter  40 value 2.217019
iter  50 value 2.168951
iter  60 value 2.163153
iter  70 value 2.125847
iter  80 value 2.116500
iter  90 value 2.105493
iter 100 value 2.100126
final  value 2.100126 
stopped after 100 iterations</code></pre>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment">
<p><strong>Step 3: Evaluate on Test Set</strong></p>
<p><strong>Confusion Matrix</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Predictions</span></span>
<span id="cb25-2"><a href="" aria-hidden="true" tabindex="-1"></a>pred_iris <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_iris, test_iris)</span>
<span id="cb25-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Confusion matrix</span></span>
<span id="cb25-4"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="at">Predicted =</span> pred_iris, <span class="at">Actual =</span> test_iris<span class="sc">$</span>Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Actual
Predicted    setosa versicolor virginica
  setosa         12          0         0
  versicolor      0         15         1
  virginica       0          0        17</code></pre>
</div>
</div>
<p><strong>Accuracy</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Accuracy</span></span>
<span id="cb27-2"><a href="" aria-hidden="true" tabindex="-1"></a>accuracy_iris <span class="ot">&lt;-</span> <span class="fu">mean</span>(pred_iris <span class="sc">==</span> test_iris<span class="sc">$</span>Species)</span>
<span id="cb27-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Iris Test Accuracy:"</span>, <span class="fu">round</span>(accuracy_iris <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>), <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Iris Test Accuracy: 97.78 %</code></pre>
</div>
</div>
</div>
</div></div>
</section>
<section id="section-7" class="slide level2 smaller">
<h2></h2>
<p><strong>Predict Probabilities</strong></p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<caption>Sample of Iris Predictions with Probabilities</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Actual</th>
<th style="text-align: left;">Predicted</th>
<th style="text-align: right;">Prob_setosa</th>
<th style="text-align: right;">Prob_versicolor</th>
<th style="text-align: right;">Prob_virginica</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.016</td>
<td style="text-align: right;">0.984</td>
</tr>
<tr class="even">
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.000</td>
</tr>
</tbody>
</table>
</div>
</div>

</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="classification_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="classification_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="classification_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="classification_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="classification_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="classification_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="classification_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="classification_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="classification_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="classification_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'slide',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    

    <script>

      // htmlwidgets need to know to resize themselves when slides are shown/hidden.

      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

      // slide changes (different for each slide format).

      (function () {

        // dispatch for htmlwidgets

        function fireSlideEnter() {

          const event = window.document.createEvent("Event");

          event.initEvent("slideenter", true, true);

          window.document.dispatchEvent(event);

        }

    

        function fireSlideChanged(previousSlide, currentSlide) {

          fireSlideEnter();

    

          // dispatch for shiny

          if (window.jQuery) {

            if (previousSlide) {

              window.jQuery(previousSlide).trigger("hidden");

            }

            if (currentSlide) {

              window.jQuery(currentSlide).trigger("shown");

            }

          }

        }

    

        // hookup for slidy

        if (window.w3c_slidy) {

          window.w3c_slidy.add_observer(function (slide_num) {

            // slide_num starts at position 1

            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

          });

        }

    

      })();

    </script>

    

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>